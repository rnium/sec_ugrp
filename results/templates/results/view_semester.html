{% extends 'results/base.html' %} {% load static %}
{% block head %}
<title>Semester: {{semester.semester_code}}</title>
{% endblock head %}

{% block nav %}
<ul class="nav">
    <li class="nav-item">
        <a href="{% url 'results:dashboard' %}" class="nav-link">
            <i class='bx bxs-dashboard'></i>
            <span>Dashboard</span>
        </a>
        <div class="tooltip">Dashboard</div>
    </li>
    <li class="nav-item active">
        <a href="{% url 'results:all_departments' %}" class="nav-link">
            <i class='bx bx-archive' ></i>
            <span>Department</span>
        </a>
        <div class="tooltip">Department</div>
    </li>
    <li class="nav-item">
        <a href="{% url 'results:extensions_view' %}" class="nav-link">
            <i class='bx bx-extension' ></i>
            <span>Extensions</span>
        </a>
        <div class="tooltip">Extensions</div>
    </li>
    <li class="nav-item">
        <a href="{% url 'results:stuffs_view' %}" class="nav-link">
            <i class='bx bx-user'></i>
            <span>Members</span>
        </a>
        <div class="tooltip">Members</div>
    </li>
    <li class="nav-item">
        <a href="{% url 'account:view_admin_profile_edit' %}" class="nav-link">
            <i class='bx bxs-spray-can'></i>
            <span>Profile</span>
        </a>
        <div class="tooltip">Profile</div>
    </li>
</ul>
{% endblock nav %}

{% block content %}
<div class="view-semester-container m-5 pt-2">
    <div class="btn-container col-md-9 d-flex justify-content-start mt-2">
        <button class="btn btn- btn-iconized px-4" {% if is_committee_shown %}data-status="shown"{% else %}data-status="hidden"{% endif %} id="committee-toggle">
            <i class='bx bxs-group {% if is_committee_shown %}text-info{% else %}text-secondary{% endif %} me-1'></i>
            {% comment %} <img src="{% static 'results/images/groups.png' %}" width="30px" alt=""> {% endcomment %}
            <span class="roboto-font {% if is_committee_shown %}text-info{% else %}text-secondary{% endif %} ms-1" style="font-size: 0.8rem;">Exam Committee</span>
        </button>
    </div>
    <div class="info">
        <div class="title">
            {% if semester.is_running %}
            <div class="title-main running fs-1 text-success">{{semester.semester_name}}</div>
            {% else %}
            <div class="title-main fs-1 text-secondary">{{semester.semester_name}}</div>
            {% endif %}
        </div>
        {% if semester.part_no or semester.repeat_number  %}
        <div class="title fs-3">
            <span class="text-secondary">{% if semester.part_no %} Part: {{semester.part_no}}{% endif %}</span>
            <span class="ms-3 text-secondary">{% if semester.repeat_number %}Repeat: {{semester.repeat_number}}{% endif %}</span>
        </div>
        {% endif %}
        <a class="session mt-2" href="{% url 'results:view_session' semester.session.dept.name semester.session.from_year semester.session.to_year %}">
            <div class="label me-2">Session</div>
            <div class="value shadow-sm">
                <span class="code">{{semester.session.session_code}}</span>
                <span class="batch-no">{{semester.session.batch_name}}</span>
            </div>
        </a>
        <div class="exam-month mt-2">
            <div class="inner d-flex">
                <i class='bx bx-calendar fs-4 me-1 text-info'></i>
                <span class="fs-6 text-info">{{semester.start_month}}</span>
            </div>
        </div>
    </div>
    <div class="committee bg-material p-3 mt-4 rounded-3 border-b-1" {% if not is_committee_shown %} style="display: none;" {% endif %} id='committee-con'>
        <div class="header text-center">Exam Committee</div>
        <div class="row p-3 committee-list" id="committee-list">
            {% if semester.committee_members %}
            {% for member in semester.committee_members %}
            <div class="col-md-4 p-1">
                <div class="member rounded-3">
                    <div class="member-profile bg-material py-4">
                        <img src="{{member.admin.avatar_url}}" alt="" class="dp mb-2">
                        <div class="info d-flex flex-column justify-content-center align-items-center">
                            <div class="name text-center">{{member.admin.user_full_name}}</div>
                            <div class="email text-center">{{member.admin.user.email}}</div>
                        </div>
                    </div>
                    <div class="action p-2 w-100">
                        <div class="designation {{member.codename}} ms-2">
                            {{member.title}}
                        </div>
                        {% if editor_access %}
                        <button class="hold remove-committee-member-btn me-2" data-url="{% url 'results:remove_committee_member' semester.id member.admin.id member.codename %}">
                            <i class='bx bx-user-minus me-2'></i>
                            <span>Remove</span>
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="no-content py-3 mt-2 d-flex flex-column justify-content-center align-items-center">
                <i class='bx bx-info-circle fs-1 text-warning'></i>
                <div class="info fs-3 mt-2 text-secondary">No Members</div>
            </div>
            {% endif %}
        </div>
        {% if semester.is_running and editor_access %}
        <div class="member-adder-container d-flex justify-content-end pe-2">
            <button class="btn btn-primary btn-iconized px-4 me-1" data-bs-toggle="modal" data-bs-target="#committeeModal">
                <i class='bx bxs-user-plus me-2'></i>
                <span class="roboto-font">Add</span>
            </button>
        </div>
        {% endif %}
        
    </div>
    <div class="all-courses bg-material p-3 mt-4 rounded-3 border-b-1">
        <div class="header text-center">All Courses</div>
        <div class="d-flex justify-content-center align-items-center mt-1">
            <i class='bx bxs-pyramid fs-5 me-2 text-secondary'></i>
            <div class="roboto-font text-secondary">{{semester.total_credits}} Credits</div>
        </div>
        <div class="courses row p-4">
            {% if semester.has_courses %}
            {% for course in courses_regular %}
            <div class="col-md-6 col-lg-4 course-container">
                <a class="course" href="{% url 'results:view_course' semester.session.dept.name course.b64_id %}">
                    <div class="course-code text-center">{{course.code}}</div>
                    <div class="course-title text-center">{{course.title|truncatechars:30}}</div>
                    <div class="d-flex justify-content-center mt-2">
                        <div class="credits d-flex justify-content-center align-items-center me-2">
                            <i class='bx bxs-pyramid text-gray fs-6 me-1'></i>
                            <span class="roboto-font text-gray" style="font-size: 0.8rem;">{{course.course_credit}} Credits</span>
                        </div>
                        <div class="students d-flex justify-content-center align-items-center ms-2">
                            <i class='bx bxs-hourglass-bottom text-gray fs-6 me-1'></i>
                            <span class="roboto-font text-gray" style="font-size: 0.8rem;">{{course.num_pending_course}}/{{course.courseresult_set.count}} Pendings</span>
                        </div>
                    </div>
                    {% if not course.is_theory_course %}
                    <div class="lab-course-badge">
                        <i class='bx bxs-flask'></i>
                        <span>Lab</span>
                    </div>
                    {% endif %}
                </a>
            </div>
            {% endfor %}
            {% for course in courses_created_drop %}
            <div class="col-md-6 col-lg-4 course-container">
                <a class="course created-drop-course" href="{% url 'results:view_course' semester.session.dept.name course.b64_id %}">
                    <div class="course-code text-center">{{course.code}}</div>
                    <div class="course-title text-center">{{course.title|truncatechars:30}}</div>
                    <div class="d-flex justify-content-center mt-2">
                        <div class="credits d-flex justify-content-center align-items-center me-2">
                            <i class='bx bxs-pyramid text-gray fs-6 me-1'></i>
                            <span class="roboto-font text-gray" style="font-size: 0.8rem;">{{course.course_credit}} Credits</span>
                        </div>
                        <div class="students d-flex justify-content-center align-items-center ms-2">
                            <i class='bx bxs-hourglass-bottom text-gray fs-6 me-1'></i>
                            <span class="roboto-font text-gray" style="font-size: 0.8rem;">{{course.num_pending_course}}/{{course.courseresult_set.count}} Pendings</span>
                        </div>
                    </div>
                    {% if not course.is_theory_course %}
                    <div class="lab-course-badge">
                        <i class='bx bxs-flask'></i>
                        <span>Lab</span>
                    </div>
                    {% endif %}
                </a>
            </div>
            {% endfor %}
            {% comment %} Drop Courses {% endcomment %}
            {% for course in courses_drop %}
            <div class="col-md-6 col-lg-4 course-container">
                <a class="course drop-course">
                    <div class="course-code text-center">{{course.code|upper}}</div>
                    <div class="course-title text-center">{{course.title|truncatechars:30}}</div>
                    <div class="credits mt-1 d-flex justify-content-center align-items-center">
                        <i class='bx bx-unite text-gray fs-6 me-1'></i>
                        <span class="roboto-font text-gray" style="font-size: 0.8rem;">{{course.course_credit}} Credits</span>
                    </div>
                    {% if not course.is_theory_course %}
                    <div class="lab-course-badge">
                        <i class='bx bxs-flask'></i>
                        <span>Lab</span>
                    </div>
                    {% endif %}
                </a>
            </div>
            {% endfor %}
            {% else %}
            <div class="no-content py-3 d-flex flex-column justify-content-center align-items-center">
                <i class='bx bx-info-circle fs-1 text-warning'></i>
                <div class="info fs-3 mt-2 text-secondary">No Courses</div>
            </div>
            {% endif %}
            
            
        </div>
        {% if semester.is_running and editor_access %}
        <div class="course-adder-container mt-2 d-flex justify-content-end border-top pt-3">
            <button class="btn btn-primary btn-iconized px-4 me-2" data-bs-toggle="modal" data-bs-target="#newEntryModal">
                <i class='bx bx-list-plus me-2'></i>
                <span class="roboto-font">Create Course</span>
            </button>
            <button class="btn btn-secondary btn-iconized px-4 me-2" data-bs-toggle="modal" data-bs-target="#dropCourseModal">
                <i class='bx bx-paperclip me-2'></i>
                <span class="roboto-font">Include Drop Course</span>
            </button>
        </div>
        {% endif %}
    </div>
    {% if semester.is_tabulation_producible %}
    <div class="tabulation bg-material p-4 mt-4 rounded-3 shadow-sm border-b-1" id="tabulation-main">
        <div class="section-title text-center mb-4 text-info">Tabulation Sheet</div>
        <div class="tabulation-card-container">
            <div id="tabulation-card" class="card mb-3 bg-material-1 shadow-sm" {% if not semester.has_tabulation_sheet %} style="display: none" {% endif %} >
                <div class="row g-0">
                  <div class="col-md-5">
                    <img src="{{semester.semesterdocument.thumb_url}}" id="tabulation-thumb" class="img-fluid rounded-start" alt="...">
                  </div>
                  <div class="col-md-7">
                    <div class="card-body p-5 d-flex flex-column h-100 justify-content-center align-items-center">
                      <p class="h4 card-title" id="tabulation-filename">{{semester.semesterdocument.tabulation_filename}}</p>
                      <div class="btn-container d-flex">
                        <a class="download-btn" href="{% url 'results:download_semester_tabulation' semester.id %}" target="_blank" id="tabulation-download">
                            <i class='bx bxs-download'></i>
                            <span>Download</span>
                        </a>
                      </div>
                      <p class="card-text mt-3"><small class="text-body-secondary" id="render_info">Last render: {{semester.semesterdocument.tabulation_sheet_render_time|date:"g:i:s A, j M o"}} by {{semester.semesterdocument.tabulation_sheet_render_by.adminaccount.user_full_name}}</small></p>
                    </div>
                  </div>
                </div>
            </div>
        </div>
        {% with semester.semesterdocument.tabulatiobn_sheet_render_config as config %}
        <div class="render-config mt-5">
            <div class="title d-flex justify-content-center">
                <i class='bx bx-cog fs-3 me-2'></i>
                <span>Render Configuration</span>
            </div>
            <div class="layout-config mt-3">
                <div class="row mt-1">
                    {% if config %}
                    <div class="col-md-6 p-2">
                        <div class="input-group">
                            <span class="input-group-text bg-material-1 roboto-font">Tabulation Title</span>
                            <input type="text" class="form-control py-2" value="{{config.render_config.tabulation_title}}" id="tabulation-title">
                        </div>
                    </div>
                    <div class="col-md-6 p-2" >
                        <div class="input-group">
                            <span class="input-group-text bg-material-1 roboto-font">Held in</span>
                            <input type="text" class="form-control py-2" value="{{config.render_config.tabulation_exam_time}}" id="tabulation-exam-time">
                        </div>
                    </div>
                    {% else %}
                    <div class="col-md-6 p-2">
                        <div class="input-group">
                            <span class="input-group-text bg-material-1 roboto-font">Tabulation Title</span>
                            <input type="text" class="form-control py-2" value="{{semester.semester_name}} Final Examination {{semester.exam_year}} {% if semester.repeat_number %}Repeat {{semester.repeat_number}}{% endif %}" id="tabulation-title">
                        </div>
                    </div>
                    <div class="col-md-6 p-2">
                        <div class="input-group">
                            <span class="input-group-text bg-material-1 roboto-font">Exam Held in</span>
                            <input type="text" class="form-control py-2" value="{{semester.held_in}}" id="tabulation-exam-time">
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div class="footer-config mt-3 px-5 pt-3 pb-5 border rounded bg-material-1">
                <div class="heading d-flex justify-content-between">
                    <div class="label text-center fs-5">Name Signature & Date</div>
                    <button id="autoInsertMembers" style="background-color: inherit; border: 0;" class="d-flex justify-content-center align-items-center">
                        <i class='bx bx-refresh fs-4 me-2 text-info'></i>
                        <span class="text-muted">Auto Insert</span>
                    </button>
                </div>
                <div class="row mt-3">
                    <div class="col-md-12 p-1">
                        <div class="form-floating">
                            <input type="text" readonly onfocus="this.removeAttribute('readonly');" class="form-control" id="chairman" placeholder="" value="{{config.footer_data.chairman}}">
                            <label for="chairman">Chairman of Exam Committee</label>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text" readonly onfocus="this.removeAttribute('readonly');" class="form-control member" id="member1" placeholder="" value="{{config.footer_data.committee_mem_1}}">
                            <label for="member1">Exam Committee Member 1</label>
                        </div>
                    </div>
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text" readonly onfocus="this.removeAttribute('readonly');" class="form-control member" id="member2" placeholder="" value="{{config.footer_data.committee_mem_2}}">
                            <label for="member2">Exam Committee Member 2</label>
                        </div>
                    </div>
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text" readonly onfocus="this.removeAttribute('readonly');" class="form-control member" id="member3" placeholder="" value="{{config.footer_data.committee_mem_3}}">
                            <label for="member3">Exam Committee Member 3</label>
                        </div>
                    </div>
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text" readonly onfocus="this.removeAttribute('readonly');" class="form-control member" id="member4" placeholder="" value="{{config.footer_data.committee_mem_4}}">
                            <label for="member4">Exam Committee Member 4</label>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text"  readonly onfocus="this.removeAttribute('readonly');" class="form-control tabulator" id="tabulator1" placeholder="" value="{{config.footer_data.tabulator_1}}">
                            <label for="tabulator1">Tabulator 1</label>
                        </div>
                    </div>
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text"  readonly onfocus="this.removeAttribute('readonly');" class="form-control tabulator" id="tabulator2" placeholder="" value="{{config.footer_data.tabulator_2}}">
                            <label for="tabulator2">Tabulator 2</label>
                        </div>
                    </div>
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text"  readonly onfocus="this.removeAttribute('readonly');" class="form-control tabulator" id="tabulator3" placeholder="" value="{{config.footer_data.tabulator_3}}">
                            <label for="tabulator3">Tabulator 3</label>
                        </div>
                    </div>
                    <div class="col-md-6 p-1">
                        <div class="form-floating">
                            <input type="text"  readonly onfocus="this.removeAttribute('readonly');" class="form-control tabulator" id="tabulator4" placeholder="" value="{{config.footer_data.tabulator_4}}">
                            <label for="tabulator4">Tabulator 4</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-3 btn-container d-flex justify-content-between align-items-center">
                <div class="d-flex justify-content-end">
                    <span class="d-inline-block ms-auto">
                        <a class="d-flex justify-content-center align-items-center" href="{% url 'results:get_semester_excel' semester.id %}" target="_blank">
                            <i class='bx bx-table fs-4 me-2 text-primary'></i>
                            <span class="text-muted">Excel Data</span>
                        </a>
                    </span>
                </div>
                <button class="ms-auto btn btn-primary btn-iconized px-4 shadow-sm" id="render-tabulation-btn">
                    <div class="content">
                        <div class="d-flex align-items-center">
                            <i class='bx bx-cog me-2 py-1'></i>
                            <span class="roboto-font ">Render</span>
                        </div>
                    </div>
                    <div class="spinner spinner-border mx-4" role="status" style="display: none;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </button>
            </div>
        </div>
        {% endwith %}
    </div>
    {% endif %}
    <div class="all-registrations bg-material p-3 mt-4 rounded-3 border-b-1">
        <div class="header text-center">Registrations <span class="bg-info text-dark px-2 small rounded" id="enroll-counter">{{semester.semesterenroll_set.count}}</span> </div>
        <div class="row students-list">
            {% for enroll in semester.semesterenroll_set.all %}
            <div class="col-md-4 p-0" id="enroll-{{enroll.id}}">
            {% if enroll.is_publishable %}
            <div class="student rounded-3">
                <div class="student-profile bg-material py-3">
                    <img src="{{enroll.student.avatar_url}}" alt="" class="dp">
                    <div class="info">
                        <div class="name">{{enroll.student.student_name}}</div>
                        <div class="reg-no">{{enroll.student.registration}}</div>
                    </div>
                </div>
                {% if editor_access and semester.is_running %} 
                <div class="btn-container py-2 w-100">
                    <button class="hold enroll-hold me-2" data-enrollid="{{enroll.id}}">
                        <i class='bx bx-stop-circle me-1' ></i>
                        <span>Hold Result</span>
                    </button>
                    <button class="delete delete-enroll" data-enrollid="{{enroll.id}}">
                        <i class='bx bxs-trash-alt' ></i>
                        <span>Delete</span>
                    </button>
                </div>
                {% endif %}
            </div>
            {% else %}
            <div class="student on-hold rounded-3">
                <div class="student-profile bg-material py-3">
                    <img src="{{enroll.student.avatar_url}}" alt="" class="dp">
                    <div class="info">
                        <div class="name">{{enroll.student.student_name}}</div>
                        <div class="reg-no">{{enroll.student.registration}}</div>
                    </div>
                </div>
                {% if editor_access and semester.is_running %} 
                <div class="btn-container py-2 w-100">
                    <button class="hold enroll-hold me-2" data-enrollid="{{enroll.id}}">
                        <i class='bx bx-play-circle me-1' ></i>
                        <span>Publish Result</span>
                    </button>
                    <button class="delete delete-enroll" data-enrollid="{{enroll.id}}">
                        <i class='bx bxs-trash-alt' ></i>
                        <span>Delete</span>
                    </button>
                </div>
                {% endif %}
            </div>
            {% endif %}
            </div>
            {% endfor %}
        </div>
        {% if editor_access and semester.is_running %}
        <div class="d-flex justify-content-end mt-3">
            <span class="d-inline-block ms-auto" style="cursor: pointer">
                <div class="d-flex justify-content-center align-items-center" data-bs-toggle="modal" data-bs-target="#newRegistrationModal">
                    <i class='bx bxs-plus-circle fs-4 me-2 text-primary'></i>
                    <span class="text-muted">Add Student Registration</span>
                </div>
            </span>
        </div>
        {% endif %}
    </div>
    
    <div class="semester-info p-3 mt-5 rounded-3 shadow">
        {% if semester.updated_in %}
        <div class="d-flex justify-content-center align-items-center mt-4">
            <i class='bx bx-history me-1 fs-5 text-secondary'></i>
            <span class="roboto-font">Last Updated: {{semester.updated_in|date:"g:i:s A, j M o"}}</span>
        </div>
        {% else %}
        <div class="d-flex justify-content-center align-items-center mt-4">
            <i class='bx bx-history me-1 fs-5 text-secondary'></i>
            <span class="roboto-font">Created on: {{semester.added_in|date:"g:i:s A, j M o"}}</span>
        </div>
        {% endif %}
        {% if semester.updated_by %}
        <div class="d-flex justify-content-center align-items-center">
            <i class='bx bx-user-check me-1 fs-4 text-secondary'></i>
            <span class="roboto-font">{{semester.updated_by.adminaccount.user_full_name}}</span>
        </div>
        {% else %}
        <div class="d-flex justify-content-center align-items-center">
            <i class='bx bx-user-check me-1 fs-4 text-secondary'></i>
            <span class="roboto-font">{{semester.added_by.adminaccount.user_full_name}}</span>
        </div>
        {% endif %}
        {% if super_access %}
        <div class="btn-container mt-2 d-flex justify-content-center my-4">
            {% if semester.prevpoint_applicable %}
            {% if semester.has_prevpoint_from_here %}
            <button class="btn btn-primary btn-iconized px-4 shadow-sm me-2" data-bs-toggle="modal" data-bs-target="#excelEntryPointUploadModal">
                <i class='bx bx-reset me-2 py-1'></i>
                <span>Update Entrypoint</span>
            </button>
            {% else %}
            <button class="btn btn-primary btn-iconized px-4 shadow-sm me-2" data-bs-toggle="modal" data-bs-target="#excelEntryPointUploadModal">
                <i class='bx bx-reset me-2 py-1'></i>
                <span>Create Entrypoint</span>
            </button>
            {% endif %}
            {% endif %}
            {% if semester.is_running %}
            <button class="btn btn-secondary btn-iconized px-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#changeWithPasswordModal">
                <i class='bx bx-lock-alt me-2 py-1'></i>
                <span>Close This Semester</span>
            </button>
            <button class="btn btn-outline-warning ms-2" data-bs-toggle="modal" data-bs-target="#semesterEditModal">Edit Semester</button>
            {% else %}
            <button class="btn btn-success btn-iconized px-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#changeWithPasswordModal">
                <i class='bx bx-play me-2 py-1'></i>
                <span>Run This Semester</span>
            </button>
            {% endif %}
            <button class="btn btn-danger ms-2 btn-iconized px-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#deleteSemesterModal">
                <i class='bx bxs-trash-alt me-2 py-1'></i>
                <span>Delete This Semester</span>
            </button>
        </div>
        {% endif %}
    </div>
    
    
    {% if semester.is_running %}
    <!-- New Course Entry Modal -->
    <div class="modal fade" id="newEntryModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-material shadow">
                <div class="modal-header">
                    <div class="modal-title text-info">Add New Course</div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div> 
                <div class="modal-body">
                    <div class="container p-0">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="courseCodeInput" placeholder="">
                                    <label for="courseCodeInput">Course Code</label>
                                </div>              
                            </div>
                            <div class="col-md-12">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="courseTitleInput" placeholder="">
                                    <label for="courseTitleInput">Course Title</label>
                                </div>              
                            </div>
                            <div class="col-md-12">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="courseCreditsInput" placeholder="">
                                    <label for="courseCreditsInput">Credits</label>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control marksinput" id="totalMarksInput" placeholder="">
                                    <label for="totalMarksInput">Total Marks</label>
                                </div>
                            </div> 
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control marksinput part-x-marks" id="partAmarksInput" placeholder="">
                                    <label for="partAmarksInput">Part A marks</label>
                                </div>              
                            </div>
                            <div class="col-md-6 ps-1">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control marksinput" id="partAmarksInputFinal" placeholder="">
                                    <label for="partAmarksInputFinal">Part A Final Marks</label>
                                </div>
                            </div> 
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control marksinput part-x-marks" id="partBmarksInput" placeholder="">
                                    <label for="partBmarksInput">Part B marks</label>
                                </div>              
                            </div> 
                            <div class="col-md-6 ps-1">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control marksinput" id="partBmarksInputFinal" placeholder="">
                                    <label for="partBmarksInputFinal">Part B Final Marks</label>
                                </div>              
                            </div>
                            <div class="col-md-12">
                                <div class="form-floating">
                                    <input type="text" class="form-control marksinput" id="inCourseMarksInput" placeholder="">
                                    <label for="inCourseMarksInput">Termtest marks</label>
                                </div>
                            </div>
                            <div class="col-md-12 mt-2">
                                <span class="text-muted me-3 ms-2">Course Type:</span>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" checked="checked" name="courseTypeOptions" id="courseTypeTheory" value="theory">
                                    <label class="form-check-label" for="courseTypeTheory">Theory</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="courseTypeOptions" id="courseTypeLab" value="lab">
                                    <label class="form-check-label" for="courseTypeLab">Lab</label>
                                </div>
                            </div>
                            <div class="col-md-12 mt-2" id="error-alert-container">
                                <div id="createCourseAlert" class="alert alert-danger roboto-font text-center" role="alert" style="display: none;font-size: 0.9rem;" >
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
                <div class="d-flex  pb-3 pe-3 justify-content-between">
                    <div class="switch-con ms-3">
                        <div class="inner d-flex justify-content-end">
                            <div class="switch">
                                <input type="checkbox" name="" id="switch-addascarrycourse">
                                <label for="switch-addascarrycourse"></label>
                            </div>
                            <div class="info me-2 text-muted ms-2">Add as a carry course</div>
                        </div>
                    </div>
                    <button type="button" id="createCourseAddBtn" class="btn btn-primary">Add</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Drop Course Modal -->
    <div class="modal fade" id="dropCourseModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content bg-material shadow">
                <div class="modal-header">
                    <div class="modal-title text-info">Select Drop Courses</div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div> 
                <div class="modal-body">
                    <div class="container p-0">
                        <div class="semester-container p-2 mt-2 mb-1 container"> 
                            {% for d_semester in drop_semesters %}
                            <div class="row g-3 p-1 border-b- bg-dark rounded shadow">
                                <a href="{% url 'results:view_semester' d_semester.session.dept.name d_semester.b64_id %}" class="semester-title my-2 text-center" target="_blank">
                                    {{d_semester.semester_name}} <span class="roboto-font">{{d_semester.session.session_code}}</span>
                                </a>
                                {% for course in d_semester.course_set.all %}
                                {% if course in semester.drop_courses.all %}
                                <div class="col-md-4 py-2 m-0">
                                    <input type="checkbox" class="btn-check existing" id="{{course.id}}"  readonly onfocus="this.removeAttribute('readonly');" checked>
                                    <label class="btn btn-outline-success w-100" for="{{course.id}}">{{course.code}}</label><br>
                                </div>
                                {% else %}
                                <div class="col-md-4 py-2 m-0">
                                    <input type="checkbox" class="btn-check" id="{{course.id}}"  readonly onfocus="this.removeAttribute('readonly');">
                                    <label class="btn btn-outline-success w-100" for="{{course.id}}">{{course.code}}</label><br>
                                </div>
                                {% endif %}
                                {% endfor %}
                                

                            </div>
                            {% endfor %}
                        </div>
                        <div class="alert text-center mt-2" role="alert" id="dropCourseModalAlert" style="display: none;">
                        </div>
                    </div>
                    
                </div>
                <div class="d-flex justify-end pb-3 pe-3 justify-content-end">
                    <button class="btn btn-primary btn-iconized px-4 shadow" id="selectionConfirmBtn" disabled>
                        <i class='bx bx-check me-1'></i>
                        <span class="roboto-font" style="font-size: 0.8rem;">Confirm Selection</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Committee Modal -->
    <div class="modal fade committee-modal" id="committeeModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-material shadow">
                <div class="modal-header">
                    <div class="modal-title text-info">Add Committee Member</div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div> 
                <div class="modal-body">
                    <div class="form-floating mb-2">
                        <select class="form-select" id="memberTypeSelect">
                            <option selected value="null" class="text-muted">Select</option>
                            <option value="chair" class="text-muted">Chairman</option>
                            <option value="member" class="text-muted">Member</option>
                            <option value="tabulator" class="text-muted">Tabulator</option>
                        </select>
                        <label for="memberTypeSelect">Commettee member type</label>
                    </div>                  
                    <input class="form-control py-2"  readonly onfocus="this.removeAttribute('readonly');" id="adminSearchInp" type="text" placeholder="Name or email of admin" aria-label="default input example">
                    <div class="user-list mt-2">
                    </div>
                    <div id="addCommitteeAlert" class="alert alert-danger mt-2 mb-2 text-center" role="alert" style="display: none;">
                    </div>   
                    <div class="d-flex mt-3 justify-content-end">
                        <button class="btn btn-primary btn-iconized px-4 shadow-sm" id="addCommitteeBtn">
                            <i class='bx bx-list-plus me-2'></i>
                            <span>Add to committee</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Semester Update Modal -->
    <div class="modal fade" id="semesterEditModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-material">
                <div class="modal-header">
                    <div class="modal-title text-info">Edit Semester</div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>              
                <div class="modal-body">
                    <div class="form-container row p-0">
                        <div class="col-md-6 mb-2 pe-1">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="yearInput" placeholder="" value="{{semester.year}}">
                                <label for="yearInput">Year No.</label>
                            </div>              
                        </div>
                        <div class="col-md-6 mb-2 ps-1">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="SemesterInput" placeholder="" value="{{semester.year_semester}}">
                                <label for="SemesterInput">Semester No.</label>
                            </div>              
                        </div>
                        <div class="col-md-12 mb-2">
                            <div class="form-floating">
                                <input type="text" class="form-control sem_main_data" id="semesterPartNo" value="{{semester.part_no}}" placeholder="">
                                <label for="semesterPartNo">Partition No.</label>
                            </div>              
                        </div>
                        <div class="col-md-12">
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="monthInput" placeholder="" value="{{semester.start_month}}">
                                <label for="monthInput">Exam Schedule (e.g., March 2023)</label>
                            </div>            
                        </div>
                        <div class="col-md-12">
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="heldInInput" placeholder="" value="{{semester.held_in}}">
                                <label for="heldInInput">Held in (e.g., April 2023)</label>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="durationInput" placeholder="" {% if semester.exam_duration %}value="{{semester.exam_duration}}"{% endif %}>
                                <label for="durationInput">Duration of Examination <small class="text-secondary">(e.g., 10/11/2023 to 05/12/2023)</small></label>
                            </div>            
                        </div>
                        <div class="col-md-12" id="repeatCountContainer">
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="repeatCount" placeholder="" value="{{semester.repeat_number}}">
                                <label for="repeatCount">Repeat Number</label>
                            </div>            
                        </div>                                   
                    </div>
                    <div id="updateSemesterAlert" class="alert alert-danger mt-3 mb-0 text-center" role="alert" style="display: none;">
                    </div>   
                </div>
                <div class="d-flex p-3 pt-0 justify-content-end">
                    <button class="btn btn-primary btn-iconized px-4 shadow-sm" id="update-semester-btn">
                        <i class='bx bx-refresh me-1'></i>
                        <span>Update</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- New Entry Modal -->
    <div class="modal fade" id="newRegistrationModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-material">
                <div class="modal-header">
                    <div class="modal-title text-info">Add Registration in {{semester.semester_code}}</div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div> 
                <div class="modal-body">
                    <div class="col-md-12 p-2">
                        <div class="input-group">
                            <span class="input-group-text bg-material-1" id="basic-addon1">Reg. No.</span>
                            <input type="text" class="form-control text-center" placeholder="" aria-label="Registration" id="new_entry_registration">
                        </div>
                        <div class="alert alert-danger mt-3 text-center" role="alert" style="display: none;" id="new_entry_alert">
                        </div>
                        <div class="d-flex justify-center justify-content-end">
                            <button type="button" class="btn btn-primary px-4 mt-2" id="new_registration_add_button">Add</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    

    <!-- Notification Modal -->
    <div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-material">
                <div class="modal-header">
                    <h1 class="modal-title text-info fs-5 text-center w-100" id="exampleModalLabel">Info</h1>
                </div>
                <div class="modal-body text-center" id="modal-body"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Close semester Modal -->
    <div class="modal fade" id="changeWithPasswordModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-material">
                <div class="modal-header">
                    <div class="modal-title text-info" id="changeWithPasswordModalLabel">Confirm Action</div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4 mt-1">Enter your password to continue</div>
                    <div class="input-group mb-3 shadow-sm">
                        <span class="input-group-text bg-material-1" id="basic-addon1"><i class='bx bx-fingerprint fs-4'></i></span>
                        <input type="password" class="form-control py-2" placeholder="Password" aria-label="Username" aria-describedby="basic-addon1">
                    </div>
                    <div class="alert alert-warning text-center" role="alert" id="changeWithPasswordModalAlert" style="display: none;">
                        Wrong Password!
                    </div>
                                                
                </div>
                <div class="d-flex justify-end pb-3 pe-3 justify-content-end">
                    <button class="ms-auto btn btn-secondary roboto-font btn-iconized px-3" id="confirm-change-btn">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete semester Modal -->
    <div class="modal fade" id="deleteSemesterModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-material">
                <div class="modal-header">
                    <div class="modal-title text-info" id="changeWithPasswordModalLabel">Confirm Action</div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4 mt-1">Enter your password to continue</div>
                    <div class="input-group mb-3 shadow-sm">
                        <span class="input-group-text bg-material-1" id="basic-addon1"><i class='bx bx-fingerprint fs-4'></i></span>
                        <input type="password" class="form-control py-2" placeholder="Password" aria-label="Username" aria-describedby="basic-addon1">
                    </div>
                    <div class="alert alert-warning text-center" role="alert" style="display: none;">
                    </div>            
                </div>
                <div class="d-flex justify-end pb-3 pe-3 justify-content-end">
                    <button class="ms-auto btn btn-secondary btn-iconized px-3 shadow-sm" id="confirm-del-btn">
                        <div class="d-flex align-items-center ">
                            <i class='bx bxs-trash-alt me-2'></i>
                            <span class="roboto-font ">Delete</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Entrypoint by Excel Modal -->
    <div class="modal fade" id="excelEntryPointUploadModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content bg-material">
                <div class="modal-header">
                    <div class="modal-title text-info">
                        The Entrypoint From This Semester
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div> 
                <div class="modal-body">
                    <div class="instructions container">
                        <div class="infotext alert alert-warning">
                            <div class="text-white text-center roboto-font mb-2">Please note before exporting</div>
                            <ul>
                                <li class="small text-warning">Column Names:</li>
                                <ul>
                                    <li class="roboto-font small">reg <span class="text-muted small">(Registration number of the students)</span> </li>
                                    <li class="roboto-font small">credits <span class="text-muted small">(Credits upto this semester)</span> </li>
                                    <li class="roboto-font small">cgpa <span class="text-muted small">(CGPA upto this semester)</span> </li>
                                </ul>
                            </ul>
                            <ul class="mb-0">
                                <li class="text-warning small">Registration number needs to be unique.</li>
                                <li class="text-warning small">Order of the columns are not necessary.</li>
                                <li class="text-warning small">Verify the data and the specified column names before uploading.</li>
                            </ul>
                        </div>
                        <div class="mb-3">
                            <label for="formFile" class="form-label">Select Excel File</label>
                            <input class="form-control" accept=".xlsx" type="file" id="excelFile">
                        </div>
                        <div class="col-md-12 mt-3 btn-container">
                            <div class="d-flex justify-content-end" >
                                <button class="ms-auto btn btn-primary btn-iconized px-4 shadow-sm" id="process-excel-btn">
                                    <div class="content">
                                        <div class="d-flex align-items-center">
                                            <i class='bx bx-export me-2'></i>
                                            <span class="roboto-font ">Export</span>
                                        </div>
                                    </div>
                                    <div class="spinner spinner-border mx-4" role="status" style="display: none;">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                </button>
                            </div>
                        </div>
                        <div class="action-summery alert alert-info mt-3" style="display: none;" id="summary_list_container">
                            <p class="text-center text-white roboto-font">Export Summery</p>
                            <ul id="summary_list">
                            </ul>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
      
</div>
{% endblock content %}
{% block script %}
<script>
    const create_course_api = "{% url 'results:create_course' %}";
    const semester_update_api = "{% url 'results:semester_update' semester.id %}";
    const drop_course_update_api = "{% url 'results:drop_course_update' semester.id %}";
    const render_tabulation_api = "{% url 'results:render_tabulation' semester.id %}";
    const change_running_status_api = "{% url 'results:change_running_status' semester.id %}";
    const delete_semester_api = "{% url 'results:delete_semester' semester.id %}";
    const create_session_prevpoint_api = "{% url 'results:create_session_prevpoint_via_excel' semester.id %}";
    const toggle_enrollment_is_publishable_api = "{% url 'results:toggle_enrollment_is_publishable' %}";
    const add_new_entry_to_semester_api = "{% url 'results:add_semester_enroll' semester.id %}";
    const committe_radio_html_api = "{% url 'results:committee_radios' %}";
    const delete_enrollment_api = "{% url 'results:delete_enrollment' %}";
    const session_url = "{% url 'results:view_session' semester.session.dept.name semester.session.from_year semester.session.to_year %}";
    const add_committee_member_api = "{% url 'results:add_committee_member' semester.id %}";
    const committee_member_names_api = "{% url 'results:committee_member_names' semester.id %}";
    const semesterId = {{semester.id}};
    const semesterNumber = {{semester.semester_no}};
    const csrftoken = "{{csrf_token}}";
</script>
<script src="{% static 'results/scripts/viewsemester1309.js' %}"></script>
{% endblock script %}

